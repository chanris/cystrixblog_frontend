import{r as g,A as F,w as A,o as O,u as Y,b as r,q as K,c as T,d as Q,f,e as a,h as l,s as W,k as V,y as X,g as _,t as Z,v as ee,E as x}from"./index-svAZxImQ.js";import{b as te,c as ae}from"./article-QCYIFHnI.js";import{_ as le}from"./_plugin-vue_export-helper-x3n3nnut.js";import"./request-Kvlrod8x.js";function R(d,h){if(arguments.length===0)return null;const w=h||"{y}-{m}-{d} {h}:{i}:{s}";let s;typeof d=="object"?s=d:((""+d).length===10&&(d=parseInt(d)*1e3),s=new Date(d));const z={y:s.getFullYear(),m:s.getMonth()+1,d:s.getDate(),h:s.getHours(),i:s.getMinutes(),s:s.getSeconds(),a:s.getDay()};return w.replace(/{(y|m|d|h|i|s|a)+}/g,(S,c)=>{let p=z[c];return c==="a"?["一","二","三","四","五","六","日"][p-1]:(S.length>0&&p<10&&(p="0"+p),p||0)})}const ne={class:"container"},oe={class:"search"},ie={class:"list"},se={style:{padding:"20px","border-bottom":"1px solid rgb(235, 238, 245)"}},re={style:{display:"flex"}},ue={class:"page"},de={__name:"index",setup(d){const h=g([]),w=F(),s=t=>!t||!t.name.split(".").pop()?!1:t.size>1024*1024*10?(x({type:"error",message:"上传文件大小限制10MB"}),!1):!0,z=t=>{x({type:"success",message:"上传成功"}),console.log(t)},S=t=>{x({type:"error",message:"上传失败"}),console.log(t)},c=g(!1),p=t=>{ae(t).then(e=>{e.code===200&&x({type:"success",message:"文章已删除"})}).finally(()=>{v({...i.value,...n.value})})},P=t=>{p({id:t.id})},i=g({title:"",timeRange:"",startTime:"",endTime:""});A(i.value,(t,e)=>{t.timeRange?(t.startTime=R(t.timeRange[0]),t.endTime=R(t.timeRange[1])):(t.startTime="",t.endTime="")});const U=()=>{v({...i.value})},B=()=>{i.value.title="",i.value.timeRange="",v({})},n=g({pageNum:1,pageSize:10,total:0}),y=g({pageNum:1,pageSize:10});A([()=>n.value.pageNum,()=>n.value.pageSize],([t,e],[C,b])=>{v({...i.value,...n.value})});const E=[{text:"最近一周",value:()=>{const t=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*7),[e,t]}},{text:"最近一个月",value:()=>{const t=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*30),[e,t]}},{text:"最近三个月",value:()=>{const t=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*90),[e,t]}}],k=g([]);O(()=>{v({...i.value,...n.value})});const v=t=>{c.value=!0,te(t).then(({result:e})=>{k.value=e.list,n.value.total=e.total,n.value.pageNum=e.pageNum,n.value.pageSize=e.pageSize,y.value.pageNum=e.pageNum,y.value.pageSize=e.pageSize}).finally(()=>{c.value=!1})},D=Y(),L=t=>{D.push({path:"/admin/article/detail",name:"adminArtileDetail",params:{id:t.id}})},M=()=>{D.push({name:"adminArticleAdd"})};return(t,e)=>{const C=r("el-input"),b=r("el-form-item"),j=r("el-date-picker"),m=r("el-button"),H=r("el-form"),u=r("el-table-column"),G=r("el-popconfirm"),I=r("el-upload"),$=r("el-table"),J=r("el-pagination"),q=K("loading");return T(),Q("div",ne,[f("div",oe,[a(H,{model:i.value,"label-width":"80px",inline:!0},{default:l(()=>[a(b,{label:"文章名称"},{default:l(()=>[a(C,{modelValue:i.value.title,"onUpdate:modelValue":e[0]||(e[0]=o=>i.value.title=o)},null,8,["modelValue"])]),_:1}),a(b,{label:"发布日期"},{default:l(()=>[a(j,{style:{height:"40px"},modelValue:i.value.timeRange,"onUpdate:modelValue":e[1]||(e[1]=o=>i.value.timeRange=o),type:"daterange","unlink-panels":"","range-separator":"->","start-placeholder":"开始时间","end-placeholder":"结束时间",shortcuts:E},null,8,["modelValue"])]),_:1}),a(b,null,{default:l(()=>[a(m,{type:"primary",style:{height:"40px"},onClick:U},{default:l(()=>[_("搜索")]),_:1}),a(m,{style:{height:"40px"},onClick:B},{default:l(()=>[_("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),f("div",ie,[f("div",se,[a(m,{type:"primary",style:{height:"40px"},onClick:M},{default:l(()=>[_("添加文章")]),_:1})]),W((T(),V($,{data:k.value,style:{width:"100%"}},{default:l(()=>[a(u,{fixed:"",prop:"index",label:"序号","min-width":"80"},{default:l(o=>[f("div",null,Z((y.value.pageNum-1)*y.value.pageSize+o.$index+1),1)]),_:1}),a(u,{prop:"title",label:"文章名称","min-width":"120"}),a(u,{prop:"wordNum",label:"文章字数","min-width":"120"}),a(u,{prop:"viewCount",label:"浏览量","min-width":"60"}),a(u,{prop:"likeCount",label:"点赞数","min-width":"60"}),a(u,{prop:"createTime",label:"发布日期","min-width":"100"}),a(u,{prop:"updateTime",label:"更新日期","min-width":"100"}),a(u,{fixed:"right",label:"操作","min-width":"100"},{default:l(o=>[f("div",re,[a(m,{link:"",type:"primary",size:"small",onClick:N=>L(o.row)},{default:l(()=>[_("详情")]),_:2},1032,["onClick"]),a(G,{title:"确定要删除该文章？",onConfirm:N=>P(o.row),"cancel-button-text":"取消","confirm-button-text":"删除","confirm-button-type":"danger"},{reference:l(()=>[a(m,{link:"",type:"danger",size:"small"},{default:l(()=>[_("删除")]),_:1})]),_:2},1032,["onConfirm"]),a(I,{"file-list":h.value,"onUpdate:fileList":e[2]||(e[2]=N=>h.value=N),headers:{authorization:ee(w).getters.token||""},data:{id:o.row.id},"show-file-list":!1,accept:".jpg,.jpeg.,.png,.PNG,.JPG,.JPEG","before-upload":s,"on-success":z,"on-error":S,action:"http://47.109.110.189:8080/admin/article/upload/cover"},{default:l(()=>[a(m,{link:"",type:"primary",size:"small"},{default:l(()=>[_("封面")]),_:1})]),_:2},1032,["file-list","headers","data"])])]),_:1})]),_:1},8,["data"])),[[q,c.value]]),f("div",ue,[k.value?(T(),V(J,{key:0,background:"",layout:"prev, pager, next",total:n.value.total,"page-size":n.value.pageSize,"onUpdate:pageSize":e[3]||(e[3]=o=>n.value.pageSize=o),"current-page":n.value.pageNum,"onUpdate:currentPage":e[4]||(e[4]=o=>n.value.pageNum=o),"hide-on-single-page":""},null,8,["total","page-size","current-page"])):X("",!0)])])])}}},fe=le(de,[["__scopeId","data-v-e470560a"]]);export{fe as default};
